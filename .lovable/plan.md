

# Add Google and Apple Sign-In + Installable Web App (PWA)

This plan covers two features: adding social login buttons (Google and Apple) to the auth page, and making the app installable directly from the browser on both iPhone and Android.

---

## Part 1: Google and Apple Sign-In

### What will change
- The login page will get "Sign in with Google" and "Sign in with Apple" buttons
- The `useAuth` hook will get a new `signInWithOAuth` method
- Both buttons will use Supabase's built-in OAuth flow

### Manual setup required (Supabase Dashboard)

**Google:**
1. Go to [Google Cloud Console](https://console.cloud.google.com) and create OAuth credentials (Web application type)
2. Set the authorized redirect URL to: `https://ckgjsgmsbszplcivxfls.supabase.co/auth/v1/callback`
3. Set authorized JavaScript origins to your app URL: `https://str-inspection-and-inventory-22.lovable.app`
4. Copy the Client ID and Client Secret
5. Go to [Supabase Auth Providers](https://supabase.com/dashboard/project/ckgjsgmsbszplcivxfls/auth/providers), enable Google, and paste the credentials

**Apple:**
1. Go to [Apple Developer Console](https://developer.apple.com/account/resources/identifiers/list) and create a Services ID
2. Enable "Sign In with Apple" and configure the domain and redirect URL (`https://ckgjsgmsbszplcivxfls.supabase.co/auth/v1/callback`)
3. Create a private key for Sign In with Apple
4. Go to [Supabase Auth Providers](https://supabase.com/dashboard/project/ckgjsgmsbszplcivxfls/auth/providers), enable Apple, and enter credentials

### Code changes

**`src/hooks/useAuth.tsx`**
- Add a `signInWithOAuth(provider: 'google' | 'apple')` method that calls `supabase.auth.signInWithOAuth`

**`src/pages/Auth.tsx`**
- Add "Sign in with Google" and "Sign in with Apple" buttons below the sign-in form with a divider ("or continue with")
- Style buttons with appropriate icons

---

## Part 2: Installable Web App (PWA)

This will let users install your app directly from their browser to their home screen on both iPhone and Android -- no app store needed.

### What will change

**Install `vite-plugin-pwa` dependency**

**`vite.config.ts`**
- Add PWA plugin with manifest configuration (app name, icons, theme color, display mode)
- Configure service worker with `navigateFallbackDenylist: [/^\/~oauth/]` to ensure OAuth redirects work properly

**`index.html`**
- Add mobile-optimized meta tags: `apple-mobile-web-app-capable`, `apple-mobile-web-app-status-bar-style`, theme-color, and manifest link

**`public/manifest.webmanifest`** (auto-generated by plugin)
- App name: "STR Management System"
- Icons in multiple sizes for Android and iOS

**`public/pwa-192x192.png` and `public/pwa-512x512.png`**
- PWA icons (generated from placeholder or existing favicon)

**`src/pages/Install.tsx`** (new page)
- A simple page at `/install` with instructions for installing the app
- Shows platform-specific instructions (iOS: Share > Add to Home Screen, Android: browser menu > Install)
- Triggers the browser's install prompt on Android when available

**`src/App.tsx`**
- Add route for `/install`

---

## Summary of files to create/modify

| File | Action |
|------|--------|
| `src/hooks/useAuth.tsx` | Add `signInWithOAuth` method |
| `src/pages/Auth.tsx` | Add Google/Apple sign-in buttons |
| `vite.config.ts` | Add PWA plugin config |
| `index.html` | Add mobile meta tags |
| `src/pages/Install.tsx` | New install instructions page |
| `src/App.tsx` | Add `/install` route |

